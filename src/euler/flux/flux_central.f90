MODULE MOD_flux_central
!===================================================================================================================================
! Central Flux
!===================================================================================================================================
! MODULES
!-----------------------------------------------------------------------------------------------------------------------------------
! IMPLICIT VARIABLE HANDLING
IMPLICIT NONE
PRIVATE
!-----------------------------------------------------------------------------------------------------------------------------------
! GLOBAL VARIABLES
!-----------------------------------------------------------------------------------------------------------------------------------
INTERFACE flux_central
   MODULE PROCEDURE flux_central
END INTERFACE
!-----------------------------------------------------------------------------------------------------------------------------------
PUBLIC  :: flux_central
!===================================================================================================================================

CONTAINS

SUBROUTINE flux_central( rho_l, rho_r, &
                         v1_l, v1_r,   &
                         v2_l, v2_r,   &
                         p_l, p_r,     &
                         flux_side     )
!===================================================================================================================================
! central flux
!===================================================================================================================================
! MODULES
USE MOD_Equation_Vars,ONLY:gamma,gamma1q
!-----------------------------------------------------------------------------------------------------------------------------------
! IMPLICIT VARIABLE HANDLING
IMPLICIT NONE
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT VARIABLES
REAL,INTENT(IN)             :: rho_l, rho_r
REAL,INTENT(IN)             :: v1_l , v1_r
REAL,INTENT(IN)             :: v2_l , v2_r
REAL,INTENT(IN)             :: p_l  , p_r
!-----------------------------------------------------------------------------------------------------------------------------------
! OUTPUT VARIABLES
REAL,INTENT(OUT)            :: flux_side(4)
!-----------------------------------------------------------------------------------------------------------------------------------
! LOCAL VARIABLES 
REAL             :: f1_r(4),f1_l(4)
REAL             :: e_r, e_l
!===================================================================================================================================

 ! Calculate Energies
 e_r = gamma*gamma1q * p_r + 0.5 * rho_r * &
       (v1_r * v1_r + v2_r * v2_r)
 e_l = gamma*gamma1q * p_l + 0.5 * rho_l * &
       (v1_l * v1_l + v2_l * v2_l)
 ! Calculate the physical fluxes
 f1_r(1) = rho_r * v1_r
 f1_r(2) = f1_r(1)*v1_r + p_r
 f1_r(3) = f1_r(1)*v2_r
 f1_r(4) = v1_r*(e_r + p_r)

 f1_l(1) = rho_l * v1_l
 f1_l(2) = f1_l(1)*v1_l + p_l
 f1_l(3) = f1_l(1)*v2_l
 f1_l(4) = v1_l*(e_l + p_l)
!-----------------------------------------------------------------------------------------------------------------------------------
 ! Calculate central fluxes
 flux_side(:) = 0.5*(f1_r(:)+f1_l(:))
!-----------------------------------------------------------------------------------------------------------------------------------
 RETURN
END SUBROUTINE flux_central
  
END MODULE MOD_flux_central
