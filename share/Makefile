### CFDFV Compile CGNS

include ../config.mk

CGNS_DIR = CGNS-$(CGNS_VERSION)
CGNS_LIB = $(CGNS_DIR)/BUILD/src/libcgns.a

.PHONY: all clean

all: $(CGNS_LIB)

$(CGNS_DIR):
	-tar -xzf $(CGNS_DIR).tar.gz

$(CGNS_LIB): $(CGNS_DIR)
	-@mkdir $(CGNS_DIR)/BUILD && \
	cd $(CGNS_DIR)/BUILD && \
	cmake \
		-Wno-dev \
		--no-warn-unused-cli \
		-DCMAKE_INSTALL_PREFIX=. \
		-DBUILD_CGNSTOOLS=OFF \
		-DCGNS_BUILD_SHARED=OFF \
		-DCGNS_USE_SHARED=ON \
		-DENABLE_64BIT=ON \
		-DENABLE_FORTRAN=ON \
		-DENABLE_HDF5=OFF \
		-DENABLE_LEGACY=ON \
		-DENABLE_SCOPING=OFF \
		-DENABLE_TESTS=OFF \
		-DCGNS_BUILD_CGNSTOOLS=OFF \
		-DCGNS_BUILD_SHARED=OFF \
		-DCGNS_BUILD_TESTING=OFF \
		-DCGNS_ENABLE_64BIT=ON \
		-DCGNS_ENABLE_BASE_SCOPE=OFF \
		-DCGNS_ENABLE_FORTRAN=ON \
		-DCGNS_ENABLE_HDF5=OFF \
		-DCGNS_ENABLE_LEGACY=ON \
		-DCGNS_ENABLE_MEM_DEBUG=OFF \
		-DCGNS_ENABLE_SCOPING=OFF \
		-DCGNS_ENABLE_TESTS=OFF \
		-DCGNS_USE_SHARED=ON \
		.. && \
	$(MAKE) install


clean:
	-@rm -rf $(CGNS_DIR)
